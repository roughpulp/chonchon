<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Compteur</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
            body {
				margin: 0px;
				background-color: #000000;
				overflow: hidden;
			}
		</style>
	</head>
	<body>
		<script src="js/three.min.js"></script>
		<script>

class Counters {
    constructor() {
        const texture = new THREE.TextureLoader().load( 'textures/digit_0.png' );
        const geometry = new THREE.CylinderGeometry( 100, 100, 200, 10 );
        const material = new THREE.MeshBasicMaterial( { map: texture } );    
        this.mesh = new THREE.Mesh( geometry, material );
        this.mesh.rotation.z += Math.PI / 2.0;
        this.mesh.rotation.x += Math.PI / 2.0;
    }
}
        
class Inputs {

    constructor() {
        this.left = false;
        this.right = false;
        this.up = false;
        this.down = false;    
    }

    registerInputHandlers(window) {
        console.log("registerInputHandlers ...");
        var inputs = this;
        var inputHandler = function(event) {
          //			console.log("key = " + event.keyCode);
          var isDown = event.type == 'keydown';
          switch (event.keyCode) {
            case 81: // left
              inputs.left = isDown;
              break;
            case 68: // right
              inputs.right = isDown;
              break;
            case 90: // up
              inputs.up = isDown;
              break;
            case 83: // down
              inputs.down = isDown;
              break;
            case 32:
              if (isDown) {
                inputs.onFireDown();
              } else {
                inputs.onFireUp();
              }
              break;
            default:
              console.log("key = " + event.keyCode);
          }
        }
        window.addEventListener('keydown', inputHandler, false);
        window.addEventListener('keyup', inputHandler, false);
        console.log("registerInputHandlers done");
    }
}

const counters = new Counters();

var camera, scene, renderer;
init();

const inputs = new Inputs();
inputs.registerInputHandlers(window);
animate();

function init() {
    camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 1, 1000 );
    camera.position.z = 400;
    scene = new THREE.Scene();
        
    scene.add( counters.mesh );
    renderer = new THREE.WebGLRenderer();
    renderer.setPixelRatio( window.devicePixelRatio );
    renderer.setSize( window.innerWidth, window.innerHeight );
    document.body.appendChild( renderer.domElement );
    //
    window.addEventListener( 'resize', onWindowResize, false );
}
function onWindowResize() {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize( window.innerWidth, window.innerHeight );
}

function animate() {
    requestAnimationFrame( animate );
    if (inputs.up) {
        counters.mesh.rotation.x -= 0.02;
    }
    if (inputs.down) {
        counters.mesh.rotation.x += 0.02;
    }
    renderer.render( scene, camera );
}

		</script>
	</body>
</html>
